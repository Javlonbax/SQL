create database stat02_lesson6

use stat02_lesson6

select * into Producrs from stat02_lesson05.[dbo].[Products]

sp_rename 'Producrs', 'Products'

select * from Products

EXEC sp_rename 'Productss', 'Products';

----- Aggrigation --- qayta ishlash
--- sum 
--- avg
--- count(), count(distinct), count(*)
--- max
--- min

select sum(StockQuantity) from Products      
select avg(StockQuantity) from Products 
select max(StockQuantity) from Products
select min(StockQuantity) from Products 

create table test(id int)
insert into test values (1),(2),(3),(Null),(4),(3),(5),(Null)
insert into test values (Null),(3)


select * from test
select count(id) from test
select count(distinct id) from test
select count(*) from test

select * from Products

select category,sum(StockQuantity) from Products 
group by category


select category,sum(Price*StockQuantity) as total from Products 
where Category <> 'Electronics'
group by category
having sum(Price*StockQuantity)>20000
order by total desc

    ishlash tartibi
from
where
group by
having
select
order by

select category,max(Price)-min(price) as result from Products 
group by category

select * from Products
select * from(select category, count(productname) as totalproducts from products
group by category) as a
pivot(max(totalproducts) 
for category in ([Accessories],[Clothing],[electronics],[furniture],[stationery],[tools])) as pvt


create table city_population (ID int, City  varchar(50),Population int, year int)

insert into city_population values
(1,'Chilonzor',2500,2012   ),
(2,'Yakkasaroy',1500,2012  ),
(3,'Mirobod',3000,2012     ),
(4,'Yashnobod',1000,2012   ),
(5,'Bektemir',2000,2012     ),
(1,'Chilonzor',2800,2013   ),
(2,'Yakkasaroy',1900,2013  ),
(3,'Mirobod',2000,2013     ),
(4,'Yashnobod',5000,2013   ),
(5,'Bektemir',1500,2013     )

select * from city_population

select * from (
select city, population,year from city_population) as a
pivot(max(population)
for year in ([2012],[2013])) as pvt
